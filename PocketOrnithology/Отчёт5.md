### **1. Задание: Реализация сетевого взаимодействия (Retrofit)**

Был создан модуль `RetrofitApp`. В качестве тестового API использовался сервис **JSONPlaceholder**.
Реализован интерфейс `ApiService` для получения списка задач (TODOs) и обновления их статуса.

**Интерфейс API (`ApiService.java`):**
```java
public interface ApiService {
    @GET("todos")
    Call<List<Todo>> getTodos();

    @PUT("todos/{id}")
    Call<Todo> updateTodo(@Path("id") int id, @Body Todo todo);
}
```

В `MainActivity` реализована логика загрузки списка и обработки нажатия на CheckBox. При изменении статуса задачи отправляется `PUT`-запрос на сервер.

**Логика обновления (`MainActivity.java`):**
```java
private void updateTodoStatus(Todo todo) {
    Call<Todo> call = apiService.updateTodo(todo.getId(), todo);

    call.enqueue(new Callback<Todo>() {
        @Override
        public void onResponse(Call<Todo> call, Response<Todo> response) {
            if (response.isSuccessful()) {
                Toast.makeText(MainActivity.this, 
                    "Статус обновлен на сервере: " + response.body().getTitle(), 
                    Toast.LENGTH_SHORT).show();
            }
        }
        // Обработка ошибок...
    });
}
```

<img width="306" height="661" alt="image" src="https://github.com/user-attachments/assets/749f1810-71c9-477d-869b-19c9d6a1a5b3" />


---

### **2. Задание: Загрузка изображений (Picasso)**

В модуль `RetrofitApp` была добавлена библиотека **Picasso**. В адаптере списка `TodoAdapter` реализована загрузка случайных изображений для каждого элемента списка с использованием сервиса `picsum.photos`. Применены трансформации: изменение размера и обрезка по центру.

**Загрузка изображения в адаптере (`TodoAdapter.java`):**
```java
String imageUrl = "https://picsum.photos/200?random=" + todo.getId();

Picasso.get()
        .load(imageUrl)
        .placeholder(R.drawable.ic_launcher_foreground) // Заглушка
        .error(R.drawable.ic_launcher_background)       // Ошибка
        .resize(150, 150)                               // Ресайз
        .centerCrop()                                   // Кроп
        .into(holder.imageView);
```

<img width="233" height="646" alt="image" src="https://github.com/user-attachments/assets/81b1f986-7c50-4fa7-a3d9-8e8418ee8725" />


---

### **3. Контрольное задание: Интеграция сети в основное приложение**

В основном проекте `PocketOrnithology` реализовано взаимодействие с **API Википедии** для получения подробной информации о птице (описание и дополнительное фото) после её распознавания.

#### **3.1. Настройка Retrofit (Data Layer)**
Создан `ApiClient` с перехватчиком для добавления заголовков и `WikipediaApi` для выполнения запросов.

**Файл `ApiClient.java`:**
```java
public static Retrofit getClient() {
    if (retrofit == null) {
        OkHttpClient.Builder httpClient = new OkHttpClient.Builder();
        httpClient.addInterceptor(chain -> {
            Request request = chain.request().newBuilder()
                    .header("User-Agent", "PocketOrnithology/1.0 (test@example.com)")
                    .build();
            return chain.proceed(request);
        });

        retrofit = new Retrofit.Builder()
                .baseUrl("https://ru.wikipedia.org/w/")
                .addConverterFactory(GsonConverterFactory.create())
                .client(httpClient.build())
                .build();
    }
    return retrofit;
}
```

#### **3.2. Реализация репозитория**
В `OrnithologyRepositoryImpl` реализован метод обращения к API. Полученные данные (JSON) десериализуются в объекты DTO (`WikipediaDto`), а затем преобразуются в доменную модель `BirdInfo`.

**Файл `OrnithologyRepositoryImpl.java`:**
```java
@Override
public void getBirdInfo(String birdName, RepositoryCallback<BirdInfo> callback) {
    wikipediaApi.getBirdExtract(birdName).enqueue(new Callback<WikipediaDto>() {
        @Override
        public void onResponse(@NonNull Call<WikipediaDto> call, @NonNull Response<WikipediaDto> response) {
            if (response.isSuccessful() && response.body() != null) {
                // Извлечение первой страницы из ответа
                WikipediaDto.Page page = response.body().query.pages.values().iterator().next();
                
                String imageUrl = (page.thumbnail != null) ? page.thumbnail.source : "";
                BirdInfo info = new BirdInfo(page.title, page.extract, imageUrl);
                
                callback.onSuccess(info);
            } else {
                callback.onFailure(new Exception("API Error"));
            }
        }
        // ...
    });
}
```

#### **3.3. Отображение данных и изображений (Glide)**
Для отображения изображения птицы, полученного из Википедии, в `ObservationDetailFragment` использована библиотека **Glide** (аналог Picasso, выбранная для проекта).

**Файл `ObservationDetailFragment.java`:**
```java
if (observation.wikiImageUrl != null && !observation.wikiImageUrl.isEmpty()) {
    // Добавляем User-Agent для корректной загрузки с Википедии
    GlideUrl urlWithHeaders = new GlideUrl(observation.wikiImageUrl, new LazyHeaders.Builder()
            .addHeader("User-Agent", "PocketOrnithology/1.0")
            .build());

    Glide.with(this)
            .load(urlWithHeaders)
            .placeholder(R.drawable.ic_launcher_foreground)
            .diskCacheStrategy(DiskCacheStrategy.ALL)
            .into(wikiImageView);
}
```

<img width="431" height="930" alt="image" src="https://github.com/user-attachments/assets/6a8d8ba8-0f12-4c8c-9632-95cfc91eb660" />
