### **1. Задание: Знакомство с Fragment**

Был создан модуль `FragmentApp`. В `MainActivity` реализовано добавление фрагмента `TaskListFragment` программным способом.
Для передачи данных во фрагмент (номер студента по списку) использовался объект `Bundle` и метод `setArguments`. В самом фрагменте данные извлекались через `getArguments()`.

**Файл `MainActivity.java` (добавление фрагмента):**
```java
if (savedInstanceState == null) {
    Bundle bundle = new Bundle();
    bundle.putInt("my_number_student", 23); // Передача данных
    TaskListFragment fragment = new TaskListFragment();
    fragment.setArguments(bundle);
    
    getSupportFragmentManager().beginTransaction()
            .setReorderingAllowed(true)
            .add(R.id.fragment_container_view, fragment, null)
            .commit();
}
```

**Файл `TaskListFragment.java` (получение данных):**
```java
@Override
public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
    super.onViewCreated(view, savedInstanceState);
    TextView tvStudentNumber = view.findViewById(R.id.tvStudentNumber);

    if (getArguments() != null) {
        int myNumber = getArguments().getInt("my_number_student");
        tvStudentNumber.setText("Мой номер по списку: " + myNumber);
    }
    // ... инициализация списка задач
}
```

<img width="549" height="688" alt="image" src="https://github.com/user-attachments/assets/66e40dda-7c0a-4884-83aa-5d0f52956e28" />


---

### **2. Задание: Fragment Manager и навигация**

Создан модуль `FragmentManagerApp`. Реализована навигация между двумя фрагментами: `ShareFragment` (список/меню) и `DetailsFragment` (детальная информация).
В `MainActivity` определен метод `showDetails`, который выполняет транзакцию замены фрагмента (`replace`) и добавляет транзакцию в бэк-стек (`addToBackStack`), что позволяет пользователю вернуться назад по кнопке Back.

**Файл `MainActivity.java` (управление навигацией):**
```java
public void showDetails(String countryName) {
    getSupportFragmentManager().beginTransaction()
            .replace(R.id.fragment_container, DetailsFragment.newInstance(countryName))
            .addToBackStack(null) // Добавление в стек возврата
            .commit();
}
```

**Файл `ShareFragment.java` (вызов навигации):**
```java
view.findViewById(R.id.buttonCountry).setOnClickListener(v -> {
    ((MainActivity) requireActivity()).showDetails("Россия");
});
```

<img width="298" height="661" alt="image" src="https://github.com/user-attachments/assets/b214de1e-ce18-4e29-aa2d-b04964784801" />

<img width="302" height="657" alt="image" src="https://github.com/user-attachments/assets/61c81f14-264a-4fe7-91d3-013cbaf34ae5" />

---

### **3. Задание: Передача данных (Fragment Result API)**

Создан модуль `ResultApiFragmentApp`. Реализована передача данных между `DataFragment` и модальным окном `BottomSheetFragment` с использованием нового API `setFragmentResult`.

В `DataFragment` по нажатию кнопки текст из поля ввода упаковывается в Bundle и отправляется слушателю. `BottomSheetFragment` подписывается на результат и отображает полученные данные.

**Файл `DataFragment.java` (отправка данных):**
```java
button.setOnClickListener(click -> {
    String text = editText.getText().toString();
    Bundle bundle = new Bundle();
    bundle.putString("key", text);

    getChildFragmentManager().setFragmentResult("requestKey", bundle);

    BottomSheetFragment bottomSheet = new BottomSheetFragment();
    bottomSheet.show(getChildFragmentManager(), "ModalBottomSheet");
});
```

**Файл `BottomSheetFragment.java` (получение данных):**
```java
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    getParentFragmentManager().setFragmentResultListener("requestKey", this, new FragmentResultListener() {
        @Override
        public void onFragmentResult(@NonNull String requestKey, @NonNull Bundle bundle) {
            String text = bundle.getString("key");
            if (textView != null) {
                textView.setText("Получено: " + text);
            }
        }
    });
}
```

<img width="319" height="672" alt="image" src="https://github.com/user-attachments/assets/9b51eaae-91f2-471f-888b-bffaa46a05c9" />

---

### **4. Контрольное задание: Фрагменты в основном приложении**

В основном проекте `PocketOrnithology` архитектура навигации была полностью переработана с использованием **Single Activity Architecture** (одна Activity, много фрагментов).

#### **4.1. Главная навигация (BottomNavigationView)**
В `MainActivity` реализована навигация через нижнюю панель. Логика переключения фрагментов осуществляется через `FragmentManager`.

**Файл `MainActivity.java`:**
```java
bottomNav.setOnItemSelectedListener(item -> {
    Fragment selectedFragment = null;
    int itemId = item.getItemId();

    if (itemId == R.id.nav_recognition) {
        selectedFragment = new RecognitionFragment();
    } else if (itemId == R.id.nav_journal) {
        // Проверка прав доступа для журнала
        if (viewModel.isGuest()) {
            Toast.makeText(this, "Только для зарегистрированных", Toast.LENGTH_SHORT).show();
            return false;
        }
        selectedFragment = new JournalFragment();
    } else if (itemId == R.id.nav_profile) {
        selectedFragment = new ProfileFragment();
    }

    if (selectedFragment != null) {
        getSupportFragmentManager().beginTransaction()
                .replace(R.id.fragment_container, selectedFragment)
                .commit();
    }
    return true;
});
```

#### **4.2. Фрагмент Профиля**
Создан новый фрагмент `ProfileFragment`. Он получает данные пользователя (имя, статус) через общую `RecognitionViewModel` и отображает информацию. Также реализована кнопка выхода из аккаунта.

**Файл `ProfileFragment.java`:**
```java
public class ProfileFragment extends Fragment {
    @Override
    public void onViewCreated(@NonNull View view, @Nullable Bundle savedInstanceState) {
        // ... инициализация View
        String userName = viewModel.getUserName();
        tvUsername.setText(userName);

        if (viewModel.isGuest()) {
            tvStatus.setText("Гостевой режим");
            btnLogout.setText("Войти в аккаунт");
        } else {
            tvStatus.setText("Авторизованный пользователь");
            btnLogout.setText("Выйти");
        }
        // Обработка нажатия на кнопку выхода
    }
}
```
<img width="437" height="929" alt="image" src="https://github.com/user-attachments/assets/9085a4e2-0715-43c3-8e50-c68f1c9e04a8" />


#### **4.3. Навигация к деталям**
Переход от списка наблюдений к деталям реализован внутри `JournalFragment` с добавлением транзакции в бэк-стек, чтобы при нажатии "Назад" пользователь возвращался к списку.

```java
ObservationDetailFragment detailFragment = ObservationDetailFragment.newInstance(observation.id);
getParentFragmentManager().beginTransaction()
        .replace(R.id.fragment_container, detailFragment)
        .addToBackStack(null)
        .commit();
```

